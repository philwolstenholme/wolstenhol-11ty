[build]
  command = "npm run build"
  publish = "dist"
  functions = "src/functions"

[dev]
  command = "npm run start"
  publish = "dist"

[[redirects]]
  from = "/proxy/cloudinary/*"
  to = "https://res.cloudinary.com/wolstenh/:splat"
  status = 200

[[redirects]]
  from = "/proxy/jsdelivr/*"
  to = "https://cdn.jsdelivr.net/:splat"
  status = 200

[[redirects]]
  from = "/api/recently-played"
  to = "https://eoh55mp2n2usj4p.m.pipedream.net"
  status = 200

[[redirects]]
  from = "/api/recently-played-spotify"
  to = "https://eoh55mp2n2usj4p.m.pipedream.net"
  status = 200

# Proxy Lambda functions
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200

[[redirects]]
  from = "https://cranky-mcnulty-01683e.netlify.app/*"
  to = "https://wolstenhol.me/:splat"
  status = 301
  force = true

[[headers]]
  for = "/*" # This defines which paths this specific [[headers]] block will cover.
  [headers.values]
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"

[[headers]]
  for = "/assets/fonts/*"
  [headers.values]
    cache-control = '''
      public,
      max-age=31536000,
      immutable'''

[[headers]]
  for = "/*.no-css*"
  [headers.values]
    X-Robots-Tag = "noindex"

[[headers]]
  for = "/*.no-js*"
  [headers.values]
    X-Robots-Tag = "noindex"

[[headers]]
  for = "/partial-*.html"
  [headers.values]
    X-Robots-Tag = "noindex"

# Redirect to custom 404. Keep this last.
[[redirects]]
  from = "/*"
  to = "/404"
  status = 404

[[plugins]]
  package = "netlify-plugin-inline-critical-css"
  [plugins.inputs]
    extract = true